[
  {
    "Name": "iis_internal_ip.rb",
    "Title": "Microsoft IIS HTTP Internal IP Disclosure",
    "Description": "Collect any leaked internal IPs by requesting commonly redirected locations from IIS. CVE-2000-0649 references IIS 5.1 (win2k, XP) and older.  However, in newer servers such as IIS 7+, this occurs when the alternateHostName is not set or misconfigured. Also collects internal IPs leaked from the PROPFIND method in certain IIS versions.",
    "CveIDs": [
      "CVE-2000-0649",
      "CVE-2002-0422"
    ],
    "EdbIDs": [
      "EDB-20096"
    ],
    "References": [
      "http://www.securityfocus.com/bid/1499",
      "http://web.archive.org/web/20201125004436/https://support.microsoft.com/en-us/help/218180/internet-information-server-returns-ip-address-in-http-header-content",
      "https://support.microsoft.com/en-us/topic/fix-the-internal-ip-address-of-an-iis-7-0-server-is-revealed-if-an-http-request-that-does-not-have-a-host-header-or-has-a-null-host-header-is-sent-to-the-server-c493e9bc-dfd3-0d9b-941c-b2d93a957d9e",
      "https://techcommunity.microsoft.com/t5/iis-support-blog/iis-web-servers-running-in-windows-azure-may-reveal-their/ba-p/826500",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/http/iis_internal_ip.rb"
    ]
  }
]
