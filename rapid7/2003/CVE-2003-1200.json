[
  {
    "Name": "mdaemon_worldclient_form2raw.rb",
    "Title": "MDaemon WorldClient form2raw.cgi Stack Buffer Overflow",
    "Description": "This module exploits a stack buffer overflow in Alt-N MDaemon SMTP server for versions 6.8.5 and earlier. When WorldClient HTTP server is installed (default), a CGI script is provided to accept html FORM based emails and deliver via MDaemon.exe, by writing the CGI output to the Raw Queue. When X-FromCheck is enabled (also default), the temporary form2raw.cgi data is copied by MDaemon.exe and a stack based overflow occurs when an excessively long From field is specified. The RawQueue is processed every 1 minute by default, to a maximum of 60 minutes. Keep this in mind when choosing payloads or setting WfsDelay... You'll need to wait. Furthermore, this exploit uses a direct memory jump into a nopsled (which isn't very reliable). Once the payload is written into the Raw Queue by Form2Raw, MDaemon will continue to crash/execute the payload until the CGI output is manually deleted from the queue in C:\\MDaemon\\RawFiles\\*.raw.",
    "CveIDs": [
      "CVE-2003-1200"
    ],
    "References": [
      "http://www.securityfocus.com/bid/9317",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/http/mdaemon_worldclient_form2raw.rb"
    ]
  }
]
