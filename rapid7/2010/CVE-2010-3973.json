[
  {
    "Name": "wmi_admintools.rb",
    "Title": "Microsoft WMI Administration Tools ActiveX Buffer Overflow",
    "Description": "This module exploits a memory trust issue in the Microsoft WMI Administration tools ActiveX control. When processing a specially crafted HTML page, the WEBSingleView.ocx ActiveX Control (1.50.1131.0) will treat the 'lCtxHandle' parameter to the 'AddContextRef' and 'ReleaseContext' methods as a trusted pointer. It makes an indirect call via this pointer which leads to arbitrary code execution.  This exploit utilizes a combination of heap spraying and the .NET 2.0 'mscorie.dll' module to bypass DEP and ASLR. This module does not opt-in to ASLR. As such, this module should be reliable on all Windows versions.  The WMI Administrative Tools are a standalone download & install (linked in the references).",
    "CveIDs": [
      "CVE-2010-3973"
    ],
    "References": [
      "http://www.securityfocus.com/bid/45546",
      "http://wooyun.org/bug.php?action=view&id=1006",
      "http://secunia.com/advisories/42693",
      "http://www.microsoft.com/downloads/en/details.aspx?FamilyID=6430f853-1120-48db-8cc5-f2abdc3ed314"
    ]
  }
]
