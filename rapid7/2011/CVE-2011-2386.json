[
  {
    "Name": "visiwave_vwr_type.rb",
    "Title": "VisiWave VWR File Parsing Vulnerability",
    "Description": "This module exploits a vulnerability found in VisiWave's Site Survey Report application. When processing .VWR files, VisiWaveReport.exe attempts to match a valid pointer based on the 'Type' property (valid ones include 'Properties', 'TitlePage', 'Details', 'Graph', 'Table', 'Text', 'Image'), but if a match isn't found, the function that's supposed to handle this routine ends up returning the input as a pointer, and later used in a CALL DWORD PTR [EDX+10] instruction.  This allows attackers to overwrite it with any arbitrary value, and results code execution.  A patch is available at visiwave.com; the fix is done by XORing the return value as null if no match is found, and then it is validated before use.  NOTE: During installation, the application will register two file handles, VWS and VWR, which allows a victim user to 'double click' the malicious VWR file and execute code.  This module was also built to bypass ASLR and DEP.",
    "CveIDs": [
      "CVE-2011-2386"
    ],
    "References": [
      "http://www.visiwave.com/blog/index.php?/archives/4-Version-2.1.9-Released.html",
      "http://www.stratsec.net/Research/Advisories/VisiWave-Site-Survey-Report-Trusted-Pointer-%28SS-20"
    ]
  }
]
