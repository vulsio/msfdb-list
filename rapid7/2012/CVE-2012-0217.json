[
  {
    "Name": "intel_sysret_priv_esc.rb",
    "Title": "FreeBSD Intel SYSRET Privilege Escalation",
    "Description": "This module exploits a vulnerability in the FreeBSD kernel, when running on 64-bit Intel processors.  By design, 64-bit processors following the X86-64 specification will trigger a general protection fault (GPF) when executing a SYSRET instruction with a non-canonical address in the RCX register.  However, Intel processors check for a non-canonical address prior to dropping privileges, causing a GPF in privileged mode. As a result, the current userland RSP stack pointer is restored and executed, resulting in privileged code execution.  This module has been tested successfully on:  FreeBSD 8.3-RELEASE (amd64); and FreeBSD 9.0-RELEASE (amd64).",
    "CveIDs": [
      "CVE-2012-0217"
    ],
    "EdbIDs": [
      "EDB-28718"
    ],
    "References": [
      "http://www.securityfocus.com/bid/53856",
      "https://packetstormsecurity.com/files/113584",
      "https://www.freebsd.org/security/patches/SA-12:04/sysret.patch",
      "https://blog.xenproject.org/2012/06/13/the-intel-sysret-privilege-escalation/",
      "https://github.com/iZsh/exploits/blob/master/stash/CVE-2012-0217-sysret/CVE-2012-0217-sysret_FreeBSD.c",
      "https://fail0verflow.com/blog/2012/cve-2012-0217-intel-sysret-freebsd/",
      "http://security.freebsd.org/advisories/FreeBSD-SA-12:04.sysret.asc",
      "https://www.slideshare.net/nkslides/exploiting-the-linux-kernel-via-intels-sysret-implementation"
    ]
  }
]
