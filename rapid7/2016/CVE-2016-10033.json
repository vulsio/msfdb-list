[
  {
    "Name": "phpmailer_arg_injection.rb",
    "Title": "PHPMailer Sendmail Argument Injection",
    "Description": "PHPMailer versions up to and including 5.2.19 are affected by a vulnerability which can be leveraged by an attacker to write a file with partially controlled contents to an arbitrary location through injection of arguments that are passed to the sendmail binary. This module writes a payload to the web root of the webserver before then executing it with an HTTP request. The user running PHPMailer must have write access to the specified WEB_ROOT directory and successful exploitation can take a few minutes.",
    "CveIDs": [
      "CVE-2016-10033",
      "CVE-2016-10045"
    ],
    "EdbIDs": [
      "EDB-40968",
      "EDB-40969"
    ],
    "References": [
      "https://github.com/opsxcq/exploit-CVE-2016-10033",
      "https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/phpmailer_arg_injection.rb"
    ]
  },
  {
    "Name": "wp_phpmailer_host_header.rb",
    "Title": "WordPress PHPMailer Host Header Command Injection",
    "Description": "This module exploits a command injection vulnerability in WordPress version 4.6 with Exim as an MTA via a spoofed Host header to PHPMailer, a mail-sending library that is bundled with WordPress. A valid WordPress username is required to exploit the vulnerability. Additionally, due to the altered Host header, exploitation is limited to the default virtual host, assuming the header isn't mangled in transit. If the target is running Apache 2.2.32 or 2.4.24 and later, the server may have HttpProtocolOptions set to Strict, preventing a Host header containing parens from passing through, making exploitation unlikely.",
    "CveIDs": [
      "CVE-2016-10033"
    ],
    "References": [
      "https://exploitbox.io/vuln/WordPress-Exploit-4-6-RCE-CODE-EXEC-CVE-2016-10033.html",
      "http://www.exim.org/exim-html-current/doc/html/spec_html/ch-string_expansions.html",
      "https://httpd.apache.org/docs/2.4/mod/core.html#httpprotocoloptions",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/webapp/wp_phpmailer_host_header.rb"
    ]
  }
]
