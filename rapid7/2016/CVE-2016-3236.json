[
  {
    "Name": "netbios_spoof_nat.rb",
    "Title": "NetBIOS Response \"BadTunnel\" Brute Force Spoof (NAT Tunnel)",
    "Description": "This module listens for a NetBIOS name request and then continuously spams NetBIOS responses to a target for given hostname, causing the target to cache a malicious address for this name. On high-speed networks, the PPSRATE value should be increased to speed up this attack. As an example, a value of around 30,000 is almost 100% successful when spoofing a response for a 'WPAD' lookup. Distant targets may require more time and lower rates for a successful attack.  This module works when the target is behind a NAT gateway, since the stream of NetBIOS responses will keep the NAT mapping alive after the initial setup. To trigger the initial NetBIOS request to the Metasploit system, force the target to access a UNC link pointing to the same address (HTML, Office attachment, etc).  This NAT-piercing issue was named the 'BadTunnel' vulnerability by the discoverer, Yu Yang (@tombkeeper). The Microsoft patches (MS16-063/MS16-077) impact the way that the proxy host (WPAD) host is identified, but do change the predictability of NetBIOS requests.",
    "CveIDs": [
      "CVE-2016-3213",
      "CVE-2016-3236"
    ],
    "References": [
      "http://technet.microsoft.com/en-us/security/bulletin/MS16-063",
      "http://technet.microsoft.com/en-us/security/bulletin/MS16-077",
      "http://xlab.tencent.com/en/2016/06/17/BadTunnel-A-New-Hope/"
    ]
  }
]