[
  {
    "Name": "tomcat_rhel_based_temp_priv_esc.rb",
    "Title": "Apache Tomcat on RedHat Based Systems Insecure Temp Config Privilege Escalation",
    "Description": "This module exploits a vulnerability in RedHat based systems where improper file permissions are applied to /usr/lib/tmpfiles.d/tomcat.conf for Apache Tomcat versions before 7.0.54-8.  This may also work against The configuration files in tmpfiles.d are used by systemd-tmpfiles to manage temporary files including their creation. With this weak permission, we're able to inject commands into systemd-tmpfiles service to write a cron job to execute our payload. systemd-tmpfiles is executed by default on boot on RedHat-based systems through systemd-tmpfiles-setup.service. Depending on the system in use, the execution of systemd-tmpfiles could also be triggered by other services, cronjobs, startup scripts etc. This module was tested against Tomcat 7.0.54-3 on Fedora 21.",
    "CveIDs": [
      "CVE-2016-5425"
    ],
    "EdbIDs": [
      "EDB-40488"
    ],
    "References": [
      "https://access.redhat.com/security/cve/CVE-2016-5425",
      "http://legalhackers.com/advisories/Tomcat-RedHat-Pkgs-Root-PrivEsc-Exploit-CVE-2016-5425.html",
      "https://www.freedesktop.org/software/systemd/man/tmpfiles.d.html",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/local/tomcat_rhel_based_temp_priv_esc.rb"
    ]
  }
]
