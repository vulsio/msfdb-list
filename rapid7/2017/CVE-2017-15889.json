[
  {
    "Name": "synology_dsm_smart_exec_auth.rb",
    "Title": "Synology DiskStation Manager smart.cgi Remote Command Execution",
    "Description": "This module exploits a vulnerability found in Synology DiskStation Manager (DSM) versions < 5.2-5967-5, which allows the execution of arbitrary commands under root privileges after website authentication. The vulnerability is located in webman/modules/StorageManager/smart.cgi, which allows appending of a command to the device to be scanned.  However, the command with drive is limited to 30 characters.  A somewhat valid drive name is required, thus /dev/sd is used, even though it doesn't exist.  To circumvent the character restriction, a wget input file is staged in /a, and executed to download our payload to /b.  From there the payload is executed.  A wfsdelay is required to give time for the payload to download, and the execution of it to run.",
    "CveIDs": [
      "CVE-2017-15889"
    ],
    "EdbIDs": [
      "EDB-43190"
    ],
    "References": [
      "https://ssd-disclosure.com/ssd-advisory-synology-storagemanager-smart-cgi-remote-command-execution/",
      "https://synology.com/en-global/security/advisory/Synology_SA_17_65_DSM",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/synology_dsm_smart_exec_auth.rb"
    ]
  }
]
