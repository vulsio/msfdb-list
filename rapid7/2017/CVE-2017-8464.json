[
  {
    "Name": "cve_2017_8464_lnk_rce.rb",
    "Title": "LNK Code Execution Vulnerability",
    "Description": "This module exploits a vulnerability in the handling of Windows Shortcut files (.LNK) that contain a dynamic icon, loaded from a malicious DLL.  This vulnerability is a variant of MS15-020 (CVE-2015-0096). The created LNK file is similar except an additional SpecialFolderDataBlock is included. The folder ID set in this SpecialFolderDataBlock is set to the Control Panel. This is enough to bypass the CPL whitelist. This bypass can be used to trick Windows into loading an arbitrary DLL file.  If no PATH is specified, the module will use drive letters D through Z so the files may be placed in the root path of a drive such as a shared VM folder or USB drive.",
    "CveIDs": [
      "CVE-2017-8464"
    ],
    "References": [
      "https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-8464",
      "http://www.vxjump.net/files/vuln_analysis/cve-2017-8464.txt",
      "https://msdn.microsoft.com/en-us/library/dd871305.aspx",
      "http://www.geoffchappell.com/notes/security/stuxnet/ctrlfldr.htm",
      "https://www.trendmicro.de/cloud-content/us/pdfs/security-intelligence/white-papers/wp-cpl-malware.pdf"
    ]
  },
  {
    "Name": "cve_2017_8464_lnk_lpe.rb",
    "Title": "LNK Code Execution Vulnerability",
    "Description": "This module exploits a vulnerability in the handling of Windows Shortcut files (.LNK) that contain a dynamic icon, loaded from a malicious DLL.  This vulnerability is a variant of MS15-020 (CVE-2015-0096). The created LNK file is similar except an additional SpecialFolderDataBlock is included. The folder ID set in this SpecialFolderDataBlock is set to the Control Panel. This is enough to bypass the CPL whitelist. This bypass can be used to trick Windows into loading an arbitrary DLL file.  The PATH option must be an absolute path to a writeable directory which is indexed for searching. If no PATH is specified, the module defaults to %USERPROFILE%.",
    "CveIDs": [
      "CVE-2017-8464"
    ],
    "References": [
      "https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-8464",
      "http://www.vxjump.net/files/vuln_analysis/cve-2017-8464.txt",
      "https://msdn.microsoft.com/en-us/library/dd871305.aspx",
      "http://www.geoffchappell.com/notes/security/stuxnet/ctrlfldr.htm",
      "https://www.trendmicro.de/cloud-content/us/pdfs/security-intelligence/white-papers/wp-cpl-malware.pdf"
    ]
  }
]