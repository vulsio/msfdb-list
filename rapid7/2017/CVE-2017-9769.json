[
  {
    "Name": "razer_zwopenprocess.rb",
    "Title": "Razer Synapse rzpnk.sys ZwOpenProcess",
    "Description": "A vulnerability exists in the latest version of Razer Synapse (v2.20.15.1104 as of the day of disclosure) which can be leveraged locally by a malicious application to elevate its privileges to those of NT_AUTHORITY\\SYSTEM. The vulnerability lies in a specific IOCTL handler in the rzpnk.sys driver that passes a PID specified by the user to ZwOpenProcess. This can be issued by an application to open a handle to an arbitrary process with the necessary privileges to allocate, read and write memory in the specified process.  This exploit leverages this vulnerability to open a handle to the winlogon process (which runs as NT_AUTHORITY\\SYSTEM) and infect it by installing a hook to execute attacker controlled shellcode. This hook is then triggered on demand by calling user32!LockWorkStation(), resulting in the attacker's payload being executed with the privileges of the infected winlogon process. In order for the issued IOCTL to work, the RazerIngameEngine.exe process must not be running. This exploit will check if it is, and attempt to kill it as necessary.  The vulnerable software can be found here: https://www.razerzone.com/synapse/. No Razer hardware needs to be connected in order to leverage this vulnerability.  This exploit is not opsec-safe due to the user being logged out as part of the exploitation process.",
    "CveIDs": [
      "CVE-2017-9769"
    ],
    "References": [
      "https://warroom.securestate.com/cve-2017-9769/"
    ]
  }
]
