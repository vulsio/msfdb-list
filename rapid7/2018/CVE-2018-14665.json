[
  {
    "Name": "xorg_x11_server.rb",
    "Title": "Xorg X11 Server Local Privilege Escalation",
    "Description": "WARNING: Successful execution of this module results in /etc/passwd being overwritten.  This module is a port of the OpenBSD X11 Xorg exploit to run on AIX.  A permission check flaw exists for -modulepath and -logfile options when starting Xorg.  This allows unprivileged users that can start the server the ability to elevate privileges and run arbitrary code under root privileges.  This module has been tested with AIX 7.1 and 7.2, and should also work with 6.1. Due to permission restrictions of the crontab in AIX, this module does not use cron, and instead overwrites /etc/passwd in order to create a new user with root privileges. All currently logged in users need to be included when /etc/passwd is overwritten, else AIX will throw 'Cannot get \"LOGNAME\" variable' when attempting to change user. The Xorg '-fp' parameter used in the OpenBSD exploit does not work on AIX, and is replaced by '-config', in conjuction with ANSI-C quotes to inject newlines when overwriting /etc/passwd.",
    "CveIDs": [
      "CVE-2018-14665"
    ],
    "EdbIDs": [
      "EDB-45938"
    ],
    "References": [
      "https://www.securepatterns.com/2018/10/cve-2018-14665-xorg-x-server.html",
      "https://aix.software.ibm.com/aix/efixes/security/xorg_advisory3.asc",
      "https://github.com/dzflack/exploits/blob/master/aix/aixxorg.pl"
    ]
  },
  {
    "Name": "xorg_x11_suid_server.rb",
    "Title": "Xorg X11 Server SUID logfile Privilege Escalation",
    "Description": "This module attempts to gain root privileges with SUID Xorg X11 server versions 1.19.0 < 1.20.3.  A permission check flaw exists for -modulepath and -logfile options when starting Xorg. This allows unprivileged users that can start the server the ability to elevate privileges and run arbitrary code under root privileges.  This module has been tested with OpenBSD 6.3, 6.4, CentOS 7.4.1708, and CentOS 7.5.1804, and RHEL 7.5. The default PAM configuration for CentOS and RHEL systems requires console auth for the user's session to start the Xorg server.  Cron launches the payload, so if SELinux is enforcing, exploitation may still be possible, but the module will bail.  Xorg must have SUID permissions and may not start if already running.  On exploitation a crontab.old backup file will be created by Xorg. This module will remove the .old file and restore crontab after successful exploitation. Failed exploitation may result in a corrupted crontab. On successful exploitation artifacts will be created consistant with starting Xorg and running a cron.",
    "CveIDs": [
      "CVE-2018-14665"
    ],
    "EdbIDs": [
      "EDB-45697",
      "EDB-45742",
      "EDB-45832"
    ],
    "References": [
      "http://www.securityfocus.com/bid/105741",
      "https://www.securepatterns.com/2018/10/cve-2018-14665-xorg-x-server.html",
      "https://github.com/0xdea/exploits/blob/master/openbsd/raptor_xorgasm"
    ]
  },
  {
    "Name": "xorg_x11_suid_server_modulepath.rb",
    "Title": "Xorg X11 Server SUID modulepath Privilege Escalation",
    "Description": "This module attempts to gain root privileges with SUID Xorg X11 server versions 1.19.0 < 1.20.3.  A permission check flaw exists for -modulepath and -logfile options when starting Xorg.  This allows unprivileged users that can start the server the ability to elevate privileges and run arbitrary code under root privileges.  This module has been tested with CentOS 7 (1708). CentOS default install will require console auth for the users session. Xorg must have SUID permissions and may not start if running.  On successful exploitation artifacts will be created consistant with starting Xorg.",
    "CveIDs": [
      "CVE-2018-14665"
    ],
    "EdbIDs": [
      "EDB-45697",
      "EDB-45742",
      "EDB-45832"
    ],
    "References": [
      "http://www.securityfocus.com/bid/105741",
      "https://www.securepatterns.com/2018/10/cve-2018-14665-another-way-of.html"
    ]
  }
]
