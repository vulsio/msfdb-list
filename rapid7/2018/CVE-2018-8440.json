[
  {
    "Name": "alpc_taskscheduler.rb",
    "Title": "Microsoft Windows ALPC Task Scheduler Local Privilege Elevation",
    "Description": "On vulnerable versions of Windows the alpc endpoint method SchRpcSetSecurity implemented by the task scheduler service can be used to write arbitrary DACLs to `.job` files located in `c:\\windows\\tasks` because the scheduler does not use impersonation when checking this location. Since users can create files in the `c:\\windows\\tasks` folder, a hardlink can be created to a file the user has read access to. After creating a hardlink, the vulnerability can be triggered to set the DACL on the linked file. WARNING: The PrintConfig.dll (%windir%\\system32\\driverstor\\filerepository\\prnms003*) on the target host will be overwritten when the exploit runs. This module has been tested against Windows 10 Pro x64.",
    "CveIDs": [
      "CVE-2018-8440"
    ],
    "References": [
      "https://github.com/SandboxEscaper/randomrepo/",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/local/alpc_taskscheduler.rb"
    ]
  }
]
