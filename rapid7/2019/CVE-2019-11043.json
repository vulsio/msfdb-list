[
  {
    "Name": "php_fpm_rce.rb",
    "Title": "PHP-FPM Underflow RCE",
    "Description": "This module exploits an underflow vulnerability in versions 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11 of PHP-FPM on Nginx. Only servers with certains Nginx + PHP-FPM configurations are exploitable. This is a port of the original neex's exploit code (see refs.). First, it detects the correct parameters (Query String Length and custom header length) needed to trigger code execution. This step determines if the target is actually vulnerable (Check method). Then, the exploit sets a series of PHP INI directives to create a file locally on the target, which enables code execution through a query string parameter. This is used to execute normal payload stagers. Finally, this module does some cleanup by killing local PHP-FPM workers (those are spawned automatically once killed) and removing the created local file.",
    "CveIDs": [
      "CVE-2019-11043"
    ],
    "EdbIDs": [
      "EDB-47553"
    ],
    "References": [
      "https://github.com/neex/phuip-fpizdam",
      "https://bugs.php.net/bug.php?id=78599",
      "https://blog.orange.tw/2019/10/an-analysis-and-thought-about-recently.html",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/php_fpm_rce.rb"
    ]
  }
]
