[
  {
    "Name": "timemachine_cmd_injection.rb",
    "Title": "Mac OS X TimeMachine (tmdiagnose) Command Injection Privilege Escalation",
    "Description": "This module exploits a command injection in TimeMachine on macOS <= 10.14.3 in order to run a payload as root. The tmdiagnose binary on OSX <= 10.14.3 suffers from a command injection vulnerability that can be exploited by creating a specially crafted disk label. The tmdiagnose binary uses awk to list every mounted volume, and composes shell commands based on the volume labels. By creating a volume label with the backtick character, we can have our own binary executed with root priviledges.",
    "CveIDs": [
      "CVE-2019-8513"
    ],
    "References": [
      "http://web.archive.org/web/20201113192302/https://medium.com/0xcc/rootpipe-reborn-part-i-cve-2019-8513-timemachine-root-command-injection-47e056b3cb43",
      "https://support.apple.com/en-in/HT209600",
      "https://github.com/ChiChou/sploits",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/osx/local/timemachine_cmd_injection.rb"
    ]
  }
]
