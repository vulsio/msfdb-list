[
  {
    "Name": "gitea_git_hooks_rce.rb",
    "Title": "Gitea Git Hooks Remote Code Execution",
    "Description": "This module leverages an insecure setting to get remote code execution on the target OS in the context of the user running Gitea. This is possible when the current user is allowed to create `git hooks`, which is the default for administrative users. For non-administrative users, the permission needs to be specifically granted by an administrator. To achieve code execution, the module authenticates to the Gitea web interface, creates a temporary repository, sets a `post-receive` git hook with the payload and creates a dummy file in the repository. This last action will trigger the git hook and execute the payload. Everything is done through the web interface. It has been mitigated in version 1.13.0 by setting the Gitea `DISABLE_GIT_HOOKS` configuration setting to `true` by default. This disables this feature and prevents all users (including admin) from creating custom git hooks. This module has been tested successfully against docker versions 1.12.5, 1.12.6 and 1.13.6 with `DISABLE_GIT_HOOKS` set to `false`, and on version 1.12.6 on Windows.",
    "CveIDs": [
      "CVE-2020-14144"
    ],
    "EdbIDs": [
      "EDB-49571"
    ],
    "References": [
      "https://podalirius.net/articles/exploiting-cve-2020-14144-gitea-authenticated-remote-code-execution/",
      "http://web.archive.org/web/20211209025818/https://www.fzi.de/en/news/news/detail-en/artikel/fsa-2020-3-schwachstelle-in-gitea-1126-und-gogs-0122-ermoeglicht-ausfuehrung-von-code-nach-authent/",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/gitea_git_hooks_rce.rb"
    ]
  }
]
