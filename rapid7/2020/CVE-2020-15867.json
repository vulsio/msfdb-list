[
  {
    "Name": "gogs_git_hooks_rce.rb",
    "Title": "Gogs Git Hooks Remote Code Execution",
    "Description": "This module leverages an insecure setting to get remote code execution on the target OS in the context of the user running Gogs. This is possible when the current user is allowed to create `git hooks`, which is the default for administrative users. For non-administrative users, the permission needs to be specifically granted by an administrator. To achieve code execution, the module authenticates to the Gogs web interface, creates a temporary repository, sets a `post-receive` git hook with the payload and creates a dummy file in the repository. This last action will trigger the git hook and execute the payload. Everything is done through the web interface. No mitigation has been implemented so far (latest stable version is 0.12.3). This module has been tested successfully against version 0.12.3 on docker. Windows version could not be tested since the git hook feature seems to be broken.",
    "CveIDs": [
      "CVE-2020-15867"
    ],
    "EdbIDs": [
      "EDB-49571"
    ],
    "References": [
      "https://podalirius.net/articles/exploiting-cve-2020-14144-gitea-authenticated-remote-code-execution/",
      "http://web.archive.org/web/20211209025818/https://www.fzi.de/en/news/news/detail-en/artikel/fsa-2020-3-schwachstelle-in-gitea-1126-und-gogs-0122-ermoeglicht-ausfuehrung-von-code-nach-authent/",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/gogs_git_hooks_rce.rb"
    ]
  }
]
