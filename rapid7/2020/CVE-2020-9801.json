[
  {
    "Name": "safari_in_operator_side_effect.rb",
    "Title": "Safari in Operator Side Effect Exploit",
    "Description": "This module exploits an incorrect side-effect modeling of the 'in' operator. The DFG compiler assumes that the 'in' operator is side-effect free, however the <embed> element with the PDF plugin provides a callback that can trigger side-effects leading to type confusion (CVE-2020-9850). The type confusion can be used as addrof and fakeobj primitives that then lead to arbitrary read/write of memory. These primitives allow us to write shellcode into a JIT region (RWX memory) containing the next stage of the exploit. The next stage uses CVE-2020-9856 to exploit a heap overflow in CVM Server, and extracts a macOS application containing our payload into /var/db/CVMS. The payload can then be opened with CVE-2020-9801, executing the payload as a user but without sandbox restrictions.",
    "CveIDs": [
      "CVE-2020-9801",
      "CVE-2020-9850",
      "CVE-2020-9856"
    ],
    "References": [
      "https://github.com/sslab-gatech/pwn2own2020",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/osx/browser/safari_in_operator_side_effect.rb"
    ]
  }
]
