[
  {
    "Name": "cfprefsd_race_condition.rb",
    "Title": "macOS cfprefsd Arbitrary File Write Local Privilege Escalation",
    "Description": "This module exploits an arbitrary file write in cfprefsd on macOS <= 10.15.4 in order to run a payload as root. The CFPreferencesSetAppValue function, which is reachable from most unsandboxed processes, can be exploited with a race condition in order to overwrite an arbitrary file as root. By overwriting /etc/pam.d/login a user can then login as root with the `login root` command without a password.",
    "CveIDs": [
      "CVE-2020-9839"
    ],
    "References": [
      "https://github.com/sslab-gatech/pwn2own2020",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/osx/local/cfprefsd_race_condition.rb"
    ]
  }
]
