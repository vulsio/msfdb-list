[
  {
    "Name": "vmware_vrops_mgr_ssrf_rce.rb",
    "Title": "VMware vRealize Operations (vROps) Manager SSRF RCE",
    "Description": "This module exploits a pre-auth SSRF (CVE-2021-21975) and post-auth file write (CVE-2021-21983) in VMware vRealize Operations Manager to leak admin creds and write/execute a JSP payload. CVE-2021-21975 affects the /casa/nodes/thumbprints endpoint, and CVE-2021-21983 affects the /casa/private/config/slice/ha/certificate endpoint. Code execution occurs as the \"admin\" Unix user. The following vRealize Operations Manager versions are vulnerable: * 7.0.0 * 7.5.0 * 8.0.0, 8.0.1 * 8.1.0, 8.1.1 * 8.2.0 * 8.3.0 Version 8.3.0 is not exploitable for creds and is therefore not supported by this module. Tested against 8.0.1.",
    "CveIDs": [
      "CVE-2021-21975",
      "CVE-2021-21983"
    ],
    "References": [
      "https://www.vmware.com/security/advisories/VMSA-2021-0004.html",
      "https://twitter.com/ptswarm/status/1376961747232382976",
      "https://attackerkb.com/topics/51Vx3lNI7B/cve-2021-21975#rapid7-analysis",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/vmware_vrops_mgr_ssrf_rce.rb"
    ]
  }
]
