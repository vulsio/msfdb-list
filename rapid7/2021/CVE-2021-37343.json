[
  {
    "Name": "nagios_xi_scanner.rb",
    "Title": "Nagios XI Scanner",
    "Description": "The module detects the version of Nagios XI applications and suggests matching exploit modules based on the version number. Since Nagios XI applications only reveal the version to authenticated users, valid credentials for a Nagios XI account are required. Alternatively, it is possible to provide a specific Nagios XI version number via the `VERSION` option. In that case, the module simply suggests matching exploit modules and does not probe the target(s).",
    "CveIDs": [
      "CVE-2019-15949",
      "CVE-2020-5791",
      "CVE-2020-5792",
      "CVE-2020-35578",
      "CVE-2021-37343"
    ],
    "References": [
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/http/nagios_xi_scanner.rb"
    ]
  },
  {
    "Name": "nagios_xi_autodiscovery_webshell.rb",
    "Title": "Nagios XI Autodiscovery Webshell Upload",
    "Description": "This module exploits a path traversal issue in Nagios XI before version 5.8.5 (CVE-2021-37343). The path traversal allows a remote and authenticated administrator to upload a PHP web shell and execute code as `www-data`. The module achieves this by creating an autodiscovery job with an `id` field containing a path traversal to a writable and remotely accessible directory, and `custom_ports` field containing the web shell. A cron file will be created using the chosen path and file name, and the web shell is embedded in the file. After the web shell has been written to the victim, this module will then use the web shell to establish a Meterpreter session or a reverse shell. By default, the web shell is deleted by the module, and the autodiscovery job is removed as well.",
    "CveIDs": [
      "CVE-2021-37343"
    ],
    "References": [
      "https://claroty.com/2021/09/21/blog-research-securing-network-management-systems-nagios-xi/",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/nagios_xi_autodiscovery_webshell.rb"
    ]
  }
]
