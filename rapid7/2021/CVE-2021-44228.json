[
  {
    "Name": "log4shell_scanner.rb",
    "Title": "Log4Shell HTTP Scanner",
    "Description": "Versions of Apache Log4j2 impacted by CVE-2021-44228 which allow JNDI features used in configuration, log messages, and parameters, do not protect against attacker controlled LDAP and other JNDI related endpoints. This module will scan an HTTP end point for the Log4Shell vulnerability by injecting a format message that will trigger an LDAP connection to Metasploit. This module is a generic scanner and is only capable of identifying instances that are vulnerable via one of the pre-determined HTTP request injection points. These points include HTTP headers and the HTTP request path. Known impacted software includes Apache Struts 2, VMWare VCenter, Apache James, Apache Solr, Apache Druid, Apache JSPWiki, Apache OFBiz.",
    "CveIDs": [
      "CVE-2021-44228",
      "CVE-2021-45046"
    ],
    "References": [
      "https://attackerkb.com/topics/in9sPR2Bzt/cve-2021-44228-log4shell/rapid7-analysis",
      "https://logging.apache.org/log4j/2.x/security.html",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/http/log4shell_scanner.rb"
    ]
  },
  {
    "Name": "mobileiron_core_log4shell.rb",
    "Title": "MobileIron Core Unauthenticated JNDI Injection RCE (via Log4Shell)",
    "Description": "MobileIron Core is affected by the Log4Shell vulnerability whereby a JNDI string sent to the server will cause it to connect to the attacker and deserialize a malicious Java object. This results in OS command execution in the context of the tomcat user. This module will start an LDAP server that the target will need to connect to.",
    "CveIDs": [
      "CVE-2021-44228"
    ],
    "References": [
      "https://attackerkb.com/topics/in9sPR2Bzt/cve-2021-44228-log4shell/rapid7-analysis",
      "https://forums.ivanti.com/s/article/Security-Bulletin-CVE-2021-44228-Remote-code-injection-in-Log4j?language=en_US",
      "https://www.mandiant.com/resources/mobileiron-log4shell-exploitation",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/mobileiron_core_log4shell.rb"
    ]
  },
  {
    "Name": "log4shell_header_injection.rb",
    "Title": "Log4Shell HTTP Header Injection",
    "Description": "Versions of Apache Log4j2 impacted by CVE-2021-44228 which allow JNDI features used in configuration, log messages, and parameters, do not protect against attacker controlled LDAP and other JNDI related endpoints. This module will exploit an HTTP end point with the Log4Shell vulnerability by injecting a format message that will trigger an LDAP connection to Metasploit and load a payload. The Automatic target delivers a Java payload using remote class loading. This requires Metasploit to run an HTTP server in addition to the LDAP server that the target can connect to. The targeted application must have the trusted code base option enabled for this technique to work. The non-Automatic targets deliver a payload via a serialized Java object. This does not require Metasploit to run an HTTP server and instead leverages the LDAP server to deliver the serialized object. The target application in this case must be compatible with the user-specified JAVA_GADGET_CHAIN option.",
    "CveIDs": [
      "CVE-2021-44228"
    ],
    "References": [
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/log4shell_header_injection.rb"
    ]
  },
  {
    "Name": "ubiquiti_unifi_log4shell.rb",
    "Title": "UniFi Network Application Unauthenticated JNDI Injection RCE (via Log4Shell)",
    "Description": "The Ubiquiti UniFi Network Application versions 5.13.29 through 6.5.53 are affected by the Log4Shell vulnerability whereby a JNDI string can be sent to the server via the 'remember' field of a POST request to the /api/login endpoint that will cause the server to connect to the attacker and deserialize a malicious Java object. This results in OS command execution in the context of the server application. This module will start an LDAP server that the target will need to connect to.",
    "CveIDs": [
      "CVE-2021-44228"
    ],
    "References": [
      "https://www.sprocketsecurity.com/blog/another-log4j-on-the-fire-unifi",
      "https://github.com/puzzlepeaches/Log4jUnifi",
      "https://community.ui.com/releases/UniFi-Network-Application-6-5-54/d717f241-48bb-4979-8b10-99db36ddabe1",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/ubiquiti_unifi_log4shell.rb"
    ]
  },
  {
    "Name": "vmware_vcenter_log4shell.rb",
    "Title": "VMware vCenter Server Unauthenticated JNDI Injection RCE (via Log4Shell)",
    "Description": "VMware vCenter Server is affected by the Log4Shell vulnerability whereby a JNDI string can sent to the server that will cause it to connect to the attacker and deserialize a malicious Java object. This results in OS command execution in the context of the root user in the case of the Linux virtual appliance and SYSTEM on Windows. This module will start an LDAP server that the target will need to connect to. This exploit uses the logon page vector.",
    "CveIDs": [
      "CVE-2021-44228"
    ],
    "References": [
      "https://attackerkb.com/topics/in9sPR2Bzt/cve-2021-44228-log4shell/rapid7-analysis",
      "https://www.vmware.com/security/advisories/VMSA-2021-0028.html",
      "https://twitter.com/w3bd3vil/status/1469814463414951937",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/vmware_vcenter_log4shell.rb"
    ]
  }
]
