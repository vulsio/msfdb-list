[
  {
    "Name": "docker_cgroup_escape.rb",
    "Title": "Docker cgroups Container Escape",
    "Description": "This exploit module takes advantage of a Docker image which has either the privileged flag, or SYS_ADMIN Linux capability. If the host kernel is vulnerable, its possible to escape the Docker image and achieve root on the host operating system. A vulnerability was found in the Linux kernel's cgroup_release_agent_write in the kernel/cgroup/cgroup-v1.c function. This flaw, under certain circumstances, allows the use of the cgroups v1 release_agent feature to escalate privileges and bypass the namespace isolation unexpectedly. More simply put, cgroups v1 has a feature called release_agent that runs a program when a process in the cgroup terminates. If notify_on_release is enabled, the kernel runs the release_agent binary as root. By editing the release_agent file, an attacker can execute their own binary with elevated privileges, taking control of the system. However, the release_agent file is owned by root, so only a user with root access can modify it.",
    "CveIDs": [
      "CVE-2022-0492"
    ],
    "References": [
      "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=24f6008564183aa120d07c03d9289519c2fe02af",
      "https://blog.trailofbits.com/2019/07/19/understanding-docker-container-escapes/",
      "https://github.com/T1erno/CVE-2022-0492-Docker-Breakout-Checker-and-PoC",
      "https://github.com/PaloAltoNetworks/can-ctr-escape-cve-2022-0492",
      "https://github.com/SofianeHamlaoui/CVE-2022-0492-Checker/blob/main/escape-check.sh",
      "https://pwning.systems/posts/escaping-containers-for-fun/",
      "https://ajxchapman.github.io/containers/2020/11/19/privileged-container-escape.html",
      "https://book.hacktricks.xyz/linux-hardening/privilege-escalation/docker-security/docker-breakout-privilege-escalation",
      "https://unit42.paloaltonetworks.com/cve-2022-0492-cgroups/",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/local/docker_cgroup_escape.rb"
    ]
  }
]
