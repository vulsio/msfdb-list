[
  {
    "Name": "softing_sis_rce.rb",
    "Title": "Softing Secure Integration Server v1.22 Remote Code Execution",
    "Description": "This module chains two vulnerabilities (CVE-2022-1373 and CVE-2022-2334) to achieve authenticated remote code execution against Softing Secure Integration Server v1.22. In CVE-2022-1373, the restore configuration feature is vulnerable to a directory traversal vulnerablity when processing zip files. When using the \"restore configuration\" feature to upload a zip file containing a path traversal file which is a dll called ..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\Windows\\System32\\wbem\\wbemcomn.dll. This causes the file C:\\Windows\\System32\\wbem\\wbemcomn.dll to be created and executed upon touching the disk. In CVE-2022-2334, the planted wbemcomn.dll is used in a DLL hijacking attack when Softing Secure Integration Server restarts upon restoring configuration, which allows us to execute arbitrary code on the target system. The chain demonstrated in Pwn2Own used a signature instead of a password. The signature was acquired by running an ARP spoofing attack against the local network where the Softing SIS server was located. A username is also required for signature authentication. A custom DLL can be provided to use in the exploit instead of using the default MSF-generated one. Refer to the module documentation for more details.",
    "CveIDs": [
      "CVE-2022-1373",
      "CVE-2022-2334"
    ],
    "References": [
      "http://www.zerodayinitiative.com/advisories/ZDI-22-1154",
      "http://www.zerodayinitiative.com/advisories/ZDI-22-1156",
      "https://industrial.softing.com/fileadmin/psirt/downloads/syt-2022-5.html",
      "https://ide0x90.github.io/softing-sis-122-rce/",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/http/softing_sis_rce.rb"
    ]
  }
]
