[
  {
    "Name": "terramaster_unauth_rce_cve_2022_24990.rb",
    "Title": "TerraMaster TOS 4.2.29 or lower - Unauthenticated RCE chaining CVE-2022-24990 and CVE-2022-24989",
    "Description": "This module exploits an unauthenticated remote code execution vulnerability in TerraMaster TOS 4.2.29 and lower by chaining two existing vulnerabilities, CVE-2022-24990 \"Leaking sensitive information\" and CVE-2022-24989, \"Authenticated remote code execution\". Exploiting vulnerable endpoint `api.php?mobile/webNasIPS` leaking sensitive information such as admin password hash and mac address, the attacker can achieve unauthenticated access and use another vulnerable endpoint `api.php?mobile/createRaid` with POST parameters `raidtype` and `diskstring` to execute remote code as root on TerraMaster NAS devices.",
    "CveIDs": [
      "CVE-2022-24990",
      "CVE-2022-24989"
    ],
    "References": [
      "https://octagon.net/blog/2022/03/07/cve-2022-24990-terrmaster-tos-unauthenticated-remote-command-execution-via-php-object-instantiation/",
      "https://github.com/0xf4n9x/CVE-2022-24990",
      "https://attackerkb.com/topics/h8YKVKx21t/cve-2022-24990",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/terramaster_unauth_rce_cve_2022_24990.rb"
    ]
  }
]
