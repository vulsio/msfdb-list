[
  {
    "Name": "vmware_vrli_rce.rb",
    "Title": "VMware vRealize Log Insight Unauthenticated RCE",
    "Description": "VMware vRealize Log Insights versions v8.x contains multiple vulnerabilities, such as directory traversal, broken access control, deserialization, and information disclosure. When chained together, these vulnerabilities allow a remote, unauthenticated attacker to execute arbitrary commands on the underlying operating system as the root user. This module achieves code execution via triggering a `RemotePakDownloadCommand` command via the exposed thrift service after obtaining the node token by calling a `GetConfigRequest` thrift command. After the download, it will trigger a `PakUpgradeCommand` for processing the specially crafted PAK archive, which then will place the JSP payload under a certain API endpoint (pre-authenticated) location upon extraction for gaining remote code execution. Successfully tested against version 8.0.2.",
    "CveIDs": [
      "CVE-2022-31706",
      "CVE-2022-31704",
      "CVE-2022-31711"
    ],
    "References": [
      "http://www.zerodayinitiative.com/advisories/ZDI-23-116",
      "http://www.zerodayinitiative.com/advisories/ZDI-23-115",
      "https://www.horizon3.ai/vmware-vrealize-log-insight-vmsa-2023-0001-technical-deep-dive",
      "https://www.vmware.com/security/advisories/VMSA-2023-0001.html",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/vmware_vrli_rce.rb"
    ]
  }
]
