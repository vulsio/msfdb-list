[
  {
    "Name": "acronis_cyber_protect_machine_info_disclosure.rb",
    "Title": "Acronis Cyber Protect/Backup machine info disclosure",
    "Description": "Acronis Cyber Protect or Backup is an enterprise backup/recovery solution for all, compute, storage and application resources. Businesses and Service Providers are using it to protect and backup all IT assets in their IT environment. This module exploits an authentication bypass vulnerability at the Acronis Cyber Protect appliance which, in its default configuration, allows the anonymous registration of new backup/protection agents on new endpoints. This API endpoint also generates bearer tokens which the agent then uses to authenticate to the appliance. As the management web console is running on the same port as the API for the agents, this bearer token is also valid for any actions on the web console. This allows an attacker with network access to the appliance to start the registration of a new agent, retrieve a bearer token that provides admin access to the available functions in the web console. This module will gather all machine info (endpoints) configured and managed by the appliance. This information can be used in a subsequent attack that exploits this vulnerability to execute arbitrary commands on both the managed endpoint and the appliance. This exploit is covered in another module `exploit/multi/acronis_cyber_protect_unauth_rce_cve_2022_3405`. Acronis Cyber Protect 15 (Windows, Linux) before build 29486 and Acronis Cyber Backup 12.5 (Windows, Linux) before build 16545 are vulnerable.",
    "CveIDs": [
      "CVE-2022-30995",
      "CVE-2022-3405"
    ],
    "References": [
      "https://herolab.usd.de/security-advisories/usd-2022-0008/",
      "https://attackerkb.com/topics/27RudJXbN4/cve-2022-30995",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/gather/acronis_cyber_protect_machine_info_disclosure.rb"
    ]
  },
  {
    "Name": "acronis_cyber_protect_unauth_rce_cve_2022_3405.rb",
    "Title": "Acronis Cyber Protect/Backup remote code execution",
    "Description": "Acronis Cyber Protect or Backup is an enterprise backup/recovery solution for all, compute, storage and application resources. Businesses and Service Providers are using it to protect and backup all IT assets in their IT environment. The Acronis Cyber Protect appliance, in its default configuration, allows the anonymous registration of new protect/backup agents on new endpoints. This API endpoint also generates bearer tokens which the agent then uses to authenticate to the appliance. As the management web console is running on the same port as the API for the agents, this bearer token is also valid for any actions on the web console. This allows an attacker with network access to the appliance to start the registration of a new agent, retrieve a bearer token that provides admin access to the available functions in the web console. The web console contains multiple possibilities to execute arbitrary commands on both the agents (e.g., via PreCommands for a backup) and also the appliance (e.g., via a Validation job on the agent of the appliance). These options can easily be set with the provided bearer token, which leads to a complete compromise of all agents and the appliance itself. You can either use the module `auxiliary/gather/acronis_cyber_protect_machine_info_disclosure` to collect target info for exploitation in this module. Or just run this module standalone and it will try to exploit the first online endpoint matching your target and payload settings configured at the module. Acronis Cyber Protect 15 (Windows, Linux) before build 29486 and Acronis Cyber Backup 12.5 (Windows, Linux) before build 16545 are vulnerable.",
    "CveIDs": [
      "CVE-2022-3405"
    ],
    "References": [
      "https://herolab.usd.de/security-advisories/usd-2022-0008/",
      "https://attackerkb.com/topics/WVI3r5eNIc/cve-2022-3405",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/acronis_cyber_protect_unauth_rce_cve_2022_3405.rb"
    ]
  }
]
