[
  {
    "Name": "fortinac_keyupload_file_write.rb",
    "Title": "Fortinet FortiNAC keyUpload.jsp arbitrary file write",
    "Description": "This module uploads a payload to the /tmp directory in addition to a cron job to /etc/cron.d which executes the payload in the context of the root user. The core vulnerability is an arbitrary file write issue in /configWizard/keyUpload.jsp which is accessible remotely and without authentication. When you send the vulnerable endpoint a ZIP file, it will extract an attacker controlled file to a directory of the attackers choice on the target system. This issue is exploitable on the following versions of FortiNAC: FortiNAC version 9.4 prior to 9.4.1 FortiNAC version 9.2 prior to 9.2.6 FortiNAC version 9.1 prior to 9.1.8 FortiNAC 8.8 all versions FortiNAC 8.7 all versions FortiNAC 8.6 all versions FortiNAC 8.5 all versions FortiNAC 8.3 all versions",
    "CveIDs": [
      "CVE-2022-39952"
    ],
    "References": [
      "https://www.horizon3.ai/fortinet-fortinac-cve-2022-39952-deep-dive-and-iocs/",
      "https://www.fortiguard.com/psirt/FG-IR-22-300",
      "https://github.com/horizon3ai/CVE-2022-39952",
      "https://attackerkb.com/topics/9BvxYuiHYJ/cve-2022-39952",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/fortinac_keyupload_file_write.rb"
    ]
  }
]
