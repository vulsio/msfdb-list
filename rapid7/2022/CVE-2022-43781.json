[
  {
    "Name": "bitbucket_env_var_rce.rb",
    "Title": "Bitbucket Environment Variable RCE",
    "Description": "For various versions of Bitbucket, there is an authenticated command injection vulnerability that can be exploited by injecting environment variables into a user name. This module achieves remote code execution as the `atlbitbucket` user by injecting the `GIT_EXTERNAL_DIFF` environment variable, a null character as a delimiter, and arbitrary code into a user's user name. The value (payload) of the `GIT_EXTERNAL_DIFF` environment variable will be run once the Bitbucket application is coerced into generating a diff. This module requires at least admin credentials, as admins and above only have the option to change their user name.",
    "CveIDs": [
      "CVE-2022-43781"
    ],
    "References": [
      "https://y4er.com/posts/cve-2022-43781-bitbucket-server-rce/",
      "https://confluence.atlassian.com/bitbucketserver/bitbucket-server-and-data-center-security-advisory-2022-11-16-1180141667.html",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/bitbucket_env_var_rce.rb"
    ]
  }
]
