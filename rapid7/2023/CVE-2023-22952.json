[
  {
    "Name": "sugarcrm_webshell_cve_2023_22952.rb",
    "Title": "SugarCRM unauthenticated Remote Code Execution (RCE)",
    "Description": "This module exploits CVE-2023-22952, a Remote Code Execution (RCE) vulnerability in SugarCRM 11.0 Enterprise, Professional, Sell, Serve, and Ultimate versions prior to 11.0.5 and SugarCRM 12.0 Enterprise, Sell, and Serve versions prior to 12.0.2. The vulnerability occurs due to a lack of appropriate validation when uploading a malicious PNG file with embedded PHP code to the /cache/images/ directory on the web server using the vulnerable endpoint /index.php?module=EmailTemplates&action=AttachFiles. Once uploaded to the server, depending on server configuration, the attacker can access the malicious PNG file via HTTP or HTTPS, thereby executing the malicious PHP code and gaining access to the system. This vulnerability does not require authentication because there is a missing authentication check in the loadUser() method in include/MVC/SugarApplication.php. After a failed login, the session does not get destroyed and hence the attacker can continue to send valid requests to the application. Because of this, any remote attacker, regardless of authentication, can exploit this vulnerability to gain access to the underlying operating system as the user that the web services are running as (typically www-data).",
    "CveIDs": [
      "CVE-2023-22952"
    ],
    "References": [
      "https://packetstormsecurity.com/files/170346",
      "https://seclists.org/fulldisclosure/2022/Dec/31",
      "https://support.sugarcrm.com/Resources/Security/sugarcrm-sa-2023-001/",
      "https://sugarclub.sugarcrm.com/engage/b/sugar-news/posts/jan-5-2023-security-vulnerability-update",
      "https://attackerkb.com/topics/E486ui94II/cve-2023-22952",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/sugarcrm_webshell_cve_2023_22952.rb"
    ]
  }
]
