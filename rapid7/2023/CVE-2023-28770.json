[
  {
    "Name": "zyxel_lfi_unauth_ssh_rce.rb",
    "Title": "Zyxel chained RCE using LFI and weak password derivation algorithm",
    "Description": "This module exploits multiple vulnerabilities in the `zhttpd` binary (/bin/zhttpd) and `zcmd` binary (/bin/zcmd). It is present on more than 40 Zyxel routers and CPE devices. The remote code execution vulnerability can be exploited by chaining the local file disclosure vulnerability in the zhttpd binary that allows an unauthenticated attacker to read the entire configuration of the router via the vulnerable endpoint `/Export_Log?/data/zcfg_config.json`. With this information disclosure, the attacker can determine if the router is reachable via ssh and use the second vulnerability in the `zcmd` binary to derive the `supervisor` password exploiting a weak implementation of a password derivation algorithm using the device serial number. After exploitation, an attacker will be able to execute any command as user `supervisor`.",
    "CveIDs": [
      "CVE-2023-28770"
    ],
    "References": [
      "https://r.sec-consult.com/zyxsploit",
      "https://sec-consult.com/vulnerability-lab/advisory/multiple-critical-vulnerabilities-in-multiple-zyxel-devices/",
      "https://th0mas.nl/2020/03/26/getting-root-on-a-zyxel-vmg8825-t50-router/",
      "https://github.com/boginw/zyxel-vmg8825-keygen",
      "https://attackerkb.com/topics/tPAvkwQgDK/cve-2023-28770",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/zyxel_lfi_unauth_ssh_rce.rb"
    ]
  }
]
