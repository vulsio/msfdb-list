[
  {
    "Name": "metabase_setup_token_rce.rb",
    "Title": "Metabase Setup Token RCE",
    "Description": "Metabase versions before 0.46.6.1 contain a flaw where the secret setup-token is accessible even after the setup process has been completed. With this token a user is able to submit the setup functionality to create a new database. When creating a new database, an H2 database string is created with a TRIGGER that allows for code execution. We use a sample database for our connection string to prevent corrupting real databases. Successfully tested against Metabase 0.46.6, 0.44.4, 0.42.1.",
    "CveIDs": [
      "CVE-2023-38646"
    ],
    "References": [
      "https://blog.assetnote.io/2023/07/22/pre-auth-rce-metabase/",
      "https://www.metabase.com/blog/security-advisory",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/metabase_setup_token_rce.rb"
    ]
  }
]
