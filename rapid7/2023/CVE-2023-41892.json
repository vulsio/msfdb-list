[
  {
    "Name": "craftcms_unauth_rce_cve_2023_41892.rb",
    "Title": "Craft CMS unauthenticated Remote Code Execution (RCE)",
    "Description": "This module exploits Remote Code Execution vulnerability (CVE-2023-41892) in Craft CMS which is a popular content management system. Craft CMS versions between 4.0.0-RC1 - 4.4.14 are  affected by this vulnerability allowing attackers to execute arbitrary code remotely, potentially compromising the security and integrity of the application. The vulnerability occurs using a PHP object creation in the `\\craft\\controllers\\ConditionsController` class which allows to run arbitrary PHP code by escalating the object creation calling some methods available in `\\GuzzleHttp\\Psr7\\FnStream`. Using this vulnerability in combination with The Imagick Extension and MSL which stands for Magick Scripting Language, a full RCE can be achieved. MSL is a built-in ImageMagick language that facilitates the reading of images, performance of image processing tasks, and writing of results back to the filesystem. This can be leveraged to create a dummy image containing malicious PHP code using the Imagick constructor class delivering a webshell that can be accessed by the attacker, thereby executing the malicious PHP code and gaining access to the system. Because of this, any remote attacker, without authentication, can exploit this vulnerability to gain access to the underlying operating system as the user that the web services are running as (typically www-data).",
    "CveIDs": [
      "CVE-2023-41892"
    ],
    "References": [
      "https://blog.calif.io/p/craftcms-rce",
      "https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/",
      "https://github.com/advisories/GHSA-4w8r-3xrw-v25g",
      "https://attackerkb.com/topics/2u7OaYlv1M/cve-2023-41892",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/craftcms_unauth_rce_cve_2023_41892.rb"
    ]
  }
]
