[
  {
    "Name": "raspberrymatic_unauth_rce_cve_2024_24578.rb",
    "Title": "RaspberryMatic unauthenticated Remote Code Execution vulnerability through HMServer File Upload.",
    "Description": "RaspberryMatic / OCCU contains a unauthenticated remote code execution (RCE) vulnerability, caused by multiple issues within the Java based HMIPServer.jar component. The webui allows for Firmware uploads which can be reached through the URL `/pages/jpages/system/DeviceFirmware/addFirmware`. This allows an unauthenticated attacker to upload a malicious .tgz archive to the server, which will be automatically extracted without any further checks. As this entry can contain ../sequences, it is possible to break out of the predefined temp directory and write files to other locations outside this path. This vulnerability is commonly known as the Zip Slip vulnerability and can be used to overwrite arbitrary files on the main filesystem. It is therefore possible to overwrite the watchdog script with a malicious payload in `/usr/local/addons/mediola/bin/`, which will be executed every five minutes through a cron job where attackers can gain remote code execution as root user, allowing a full system compromise. RaspberryMatic versions <= `3.73.9.20240130` are vulnerable.",
    "CveIDs": [
      "CVE-2024-24578"
    ],
    "References": [
      "https://attackerkb.com/topics/ywHhBnSObR/cve-2024-24578",
      "https://github.com/jens-maus/RaspberryMatic/security/advisories/GHSA-q967-q4j8-637h",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/raspberrymatic_unauth_rce_cve_2024_24578.rb"
    ]
  }
]
