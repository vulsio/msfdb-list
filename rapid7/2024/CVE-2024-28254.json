[
  {
    "Name": "openmetadata_auth_bypass_rce.rb",
    "Title": "OpenMetadata authentication bypass and SpEL injection exploit chain",
    "Description": "OpenMetadata is a unified platform for discovery, observability, and governance powered by a central metadata repository, in-depth lineage, and seamless team collaboration. This module chains two vulnerabilities that exist in the OpenMetadata aplication. The first vulnerability, CVE-2024-28255, bypasses the API authentication using JWT tokens. It misuses the `JwtFilter` that checks the path of the url endpoint against a list of excluded endpoints that does not require authentication. Unfortunately, an attacker may use Path Parameters to make any path contain any arbitrary strings that will match the excluded endpoint condition and therefore will be processed with no JWT validation allowing an attacker to bypass the authentication mechanism and reach any arbitrary endpoint. By chaining this vulnerability with CVE-2024-28254, that allows for arbitrary SpEL injection at endpoint `/api/v1/events/subscriptions/validation/condition/<expression>`, attackers are able to run arbitrary commands using Java classes such as `java.lang.Runtime` without any authentication. OpenMetadata versions `1.2.3` and below are vulnerable.",
    "CveIDs": [
      "CVE-2024-28255",
      "CVE-2024-28254"
    ],
    "References": [
      "https://securitylab.github.com/advisories/GHSL-2023-235_GHSL-2023-237_Open_Metadata/",
      "https://attackerkb.com/topics/f19fXpZn62/cve-2024-28255",
      "https://ethicalhacking.uk/unmasking-cve-2024-28255-authentication-bypass-in-openmetadata/",
      "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/openmetadata_auth_bypass_rce.rb"
    ]
  }
]
